<!DOCTYPE html><html lang="en"><head><title>js/h</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="js/h"><meta name="groc-project-path" content="js/h.coffee"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">js/h.coffee</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="k">class</span> <span class="nx">Helpers</span>
  <span class="nv">logBadgeCss: </span><span class="s">&#39;background:#3A0839;color:#FF512F;border-radius:5px;</span>
<span class="s">    padding: 1px 5px 2px; border: 1px solid #FF512F;&#39;</span>
  <span class="nv">shortColors:</span>
    <span class="nv">transparent: </span><span class="s">&#39;rgba(0,0,0,0)&#39;</span>
    <span class="nv">aqua: </span>  <span class="s">&#39;rgb(0,255,255)&#39;</span>
    <span class="nv">black: </span> <span class="s">&#39;rgb(0,0,0)&#39;</span>
    <span class="nv">blue: </span>  <span class="s">&#39;rgb(0,0,255)&#39;</span>
    <span class="nx">fuchsia</span><span class="o">:</span><span class="s">&#39;rgb(255,0,255)&#39;</span>
    <span class="nv">gray: </span>  <span class="s">&#39;rgb(128,128,128)&#39;</span>
    <span class="nv">green: </span> <span class="s">&#39;rgb(0,128,0)&#39;</span>
    <span class="nv">lime: </span>  <span class="s">&#39;rgb(0,255,0)&#39;</span>
    <span class="nv">maroon: </span><span class="s">&#39;rgb(128,0,0)&#39;</span>
    <span class="nv">navy: </span>  <span class="s">&#39;rgb(0,0,128)&#39;</span>
    <span class="nv">olive: </span> <span class="s">&#39;rgb(128,128,0)&#39;</span>
    <span class="nv">purple: </span><span class="s">&#39;rgb(128,0,128)&#39;</span>
    <span class="nv">red: </span>   <span class="s">&#39;rgb(255,0,0)&#39;</span>
    <span class="nv">silver: </span><span class="s">&#39;rgb(192,192,192)&#39;</span>
    <span class="nv">teal: </span>  <span class="s">&#39;rgb(0,128,128)&#39;</span>
    <span class="nv">white: </span> <span class="s">&#39;rgb(255,255,255)&#39;</span>
    <span class="nv">yellow: </span><span class="s">&#39;rgb(255,255,0)&#39;</span>
    <span class="nv">orange: </span><span class="s">&#39;rgb(255,128,0)&#39;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>none-tweenable props</p></div></div><div class="code"><div class="wrapper">  <span class="nv">chainOptionMap:</span>
    <span class="nv">duration: </span>        <span class="mi">1</span>
    <span class="nv">delay: </span>           <span class="mi">1</span>
    <span class="nv">repeat: </span>          <span class="mi">1</span>
    <span class="nv">easing: </span>          <span class="mi">1</span>
    <span class="nv">yoyo: </span>            <span class="mi">1</span>
    <span class="nv">onStart: </span>         <span class="mi">1</span>
    <span class="nv">onComplete: </span>      <span class="mi">1</span>
    <span class="nv">onCompleteChain: </span> <span class="mi">1</span>
    <span class="nv">onUpdate: </span>        <span class="mi">1</span>
    <span class="nv">points: </span>          <span class="mi">1</span>
  <span class="nv">callbacksMap:</span>
    <span class="nv">onStart: </span>         <span class="mi">1</span>
    <span class="nv">onComplete: </span>      <span class="mi">1</span>
    <span class="nv">onCompleteChain: </span> <span class="mi">1</span>
    <span class="nv">onUpdate: </span>        <span class="mi">1</span>
  <span class="nv">tweenOptionMap:</span>
    <span class="nv">duration: </span>        <span class="mi">1</span>
    <span class="nv">delay: </span>           <span class="mi">1</span>
    <span class="nv">repeat: </span>          <span class="mi">1</span>
    <span class="nv">easing: </span>          <span class="mi">1</span>
    <span class="nv">yoyo: </span>            <span class="mi">1</span>
  <span class="nv">posPropsMap:</span>
    <span class="nv">x: </span>               <span class="mi">1</span>
    <span class="nv">y: </span>               <span class="mi">1</span>
    <span class="nv">shiftX: </span>          <span class="mi">1</span>
    <span class="nv">shiftY: </span>          <span class="mi">1</span>

    <span class="nv">burstX: </span>          <span class="mi">1</span>
    <span class="nv">burstY: </span>          <span class="mi">1</span>
    <span class="nv">burstShiftX: </span>     <span class="mi">1</span>
    <span class="nv">burstShiftY: </span>     <span class="mi">1</span>

  <span class="nv">strokeDashPropsMap:</span>
    <span class="nv">strokeDasharray: </span> <span class="mi">1</span>
    <span class="nv">strokeDashoffset: </span><span class="mi">1</span>


  <span class="nv">RAD_TO_DEG: </span><span class="mi">180</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span>
  <span class="nx">constructor</span><span class="o">:</span><span class="nf">-&gt;</span> <span class="nx">@vars</span><span class="p">()</span>
  <span class="nx">vars</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="vi">@prefix = </span><span class="nx">@getPrefix</span><span class="p">()</span>
    <span class="nx">@getRemBase</span><span class="p">()</span>
    <span class="vi">@isFF = </span><span class="nx">@prefix</span><span class="p">.</span><span class="nx">lowercase</span> <span class="o">is</span> <span class="s">&#39;moz&#39;</span>
    <span class="vi">@isIE = </span><span class="nx">@prefix</span><span class="p">.</span><span class="nx">lowercase</span> <span class="o">is</span> <span class="s">&#39;ms&#39;</span>
    <span class="vi">@isOldOpera = </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span> <span class="sr">/presto/gim</span>

    <span class="vi">@div = </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">)</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span> <span class="nx">@div</span>

  <span class="nx">cloneObj</span><span class="o">:</span><span class="nf">(obj, exclude)-&gt;</span>
    <span class="nv">keys = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="nv">newObj = </span><span class="p">{};</span> <span class="nv">i = </span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span>
    <span class="k">while</span><span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span>
      <span class="nv">key = </span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>skip the keys defined in exclude object</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="nx">exclude</span><span class="o">?</span> <span class="k">then</span> <span class="nx">newObj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="k">if</span> <span class="o">!</span><span class="nx">exclude</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
      <span class="k">else</span> <span class="nx">newObj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
    <span class="nx">newObj</span>
  <span class="nx">extend</span><span class="o">:</span><span class="nf">(objTo, objFrom)-&gt;</span>
    <span class="k">for</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">objFrom</span>
      <span class="nx">objTo</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">?=</span> <span class="nx">objFrom</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
  <span class="nx">getRemBase</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="nv">html = </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s">&#39;html&#39;</span><span class="p">)</span>
    <span class="nv">style = </span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span>
    <span class="vi">@remBase = </span><span class="nb">parseFloat</span> <span class="nx">style</span><span class="p">.</span><span class="nx">fontSize</span>

  <span class="nx">clamp</span><span class="o">:</span><span class="nf">(value, min, max)-&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">min</span><span class="p">),</span> <span class="nx">max</span>

  <span class="nx">setPrefixedStyle</span><span class="o">:</span><span class="nf">(el, name, value)-&gt;</span>
    <span class="nv">prefixedName            = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@prefix</span><span class="p">.</span><span class="nx">css</span><span class="si">}#{</span><span class="nx">name</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span>          <span class="o">=</span> <span class="nx">value</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">prefixedName</span><span class="p">]</span>  <span class="o">=</span> <span class="nx">value</span>
  <span class="nx">prepareForLog</span><span class="o">:</span><span class="nf">(args)-&gt;</span>
    <span class="nv">args = </span><span class="nb">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">args</span>
    <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s">&#39;::&#39;</span><span class="p">);</span> <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">@logBadgeCss</span><span class="p">);</span> <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s">&#39;%cmoÂ·js%c&#39;</span><span class="p">)</span>
    <span class="nx">args</span>
  <span class="nx">log</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="k">if</span> <span class="nx">mojs</span><span class="p">.</span><span class="nx">isDebug</span> <span class="o">is</span> <span class="kc">false</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">console</span><span class="p">,</span> <span class="nx">@prepareForLog</span> <span class="nx">arguments</span>
  <span class="nx">warn</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="k">if</span> <span class="nx">mojs</span><span class="p">.</span><span class="nx">isDebug</span> <span class="o">is</span> <span class="kc">false</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">console</span><span class="p">,</span> <span class="nx">@prepareForLog</span> <span class="nx">arguments</span>
  <span class="nx">error</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="k">if</span> <span class="nx">mojs</span><span class="p">.</span><span class="nx">isDebug</span> <span class="o">is</span> <span class="kc">false</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">console</span><span class="p">,</span> <span class="nx">@prepareForLog</span> <span class="nx">arguments</span>
  <span class="nx">parseUnit</span><span class="o">:</span><span class="nf">(value)-&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">value</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span>
      <span class="k">return</span> <span class="nv">returnVal =</span>
        <span class="nv">unit: </span>    <span class="s">&#39;px&#39;</span>
        <span class="nv">isStrict: </span>  <span class="kc">false</span>
        <span class="nv">value: </span>   <span class="nx">value</span>
        <span class="nv">string: </span>  <span class="s">&quot;</span><span class="si">#{</span><span class="nx">value</span><span class="si">}</span><span class="s">px&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">value</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span>
      <span class="nv">regex = </span><span class="sr">/px|%|rem|em|ex|cm|ch|mm|in|pt|pc|vh|vw|vmin/gim</span>
      <span class="nv">unit = </span><span class="nx">value</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">regex</span><span class="p">)</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="nv">isStrict = </span><span class="kc">true</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if a plain number was passed set isStrict to false and add px</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="o">!</span><span class="nx">unit</span> <span class="k">then</span> <span class="nv">unit = </span><span class="s">&#39;px&#39;</span><span class="p">;</span> <span class="nv">isStrict = </span><span class="kc">false</span>
      <span class="nv">amount = </span><span class="nb">parseFloat</span> <span class="nx">value</span>
      <span class="k">return</span> <span class="nv">returnVal =</span>
        <span class="nv">unit: </span>    <span class="nx">unit</span>
        <span class="nv">isStrict: </span><span class="nx">isStrict</span>
        <span class="nv">value: </span>   <span class="nx">amount</span>
        <span class="nv">string: </span>  <span class="s">&quot;</span><span class="si">#{</span><span class="nx">amount</span><span class="si">}#{</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">value</span>
  <span class="nx">bind</span><span class="o">:</span><span class="nf">(func, context) -&gt;</span>
    <span class="nv">wrapper = </span><span class="nf">-&gt;</span>
      <span class="nv">args = </span><span class="nb">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span>
      <span class="nv">unshiftArgs = </span><span class="nx">bindArgs</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span>
      <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">unshiftArgs</span>
    <span class="nv">bindArgs = </span><span class="nb">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">wrapper</span>
  <span class="nx">getRadialPoint</span><span class="o">:</span><span class="nf">(o={})-&gt;</span>
    <span class="k">return</span> <span class="k">if</span> <span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">radius</span><span class="o">?</span> <span class="o">or</span> <span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">angle</span><span class="o">?</span> <span class="o">or</span> <span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">center</span><span class="o">?</span>
    <span class="nv">radAngle = </span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">angle</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
    <span class="nv">radiusX = </span><span class="k">if</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radiusX</span><span class="o">?</span> <span class="k">then</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radiusX</span> <span class="k">else</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radius</span>
    <span class="nv">radiusY = </span><span class="k">if</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radiusY</span><span class="o">?</span> <span class="k">then</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radiusY</span> <span class="k">else</span> <span class="nx">o</span><span class="p">.</span><span class="nx">radius</span>
    <span class="nv">point =</span>
      <span class="nv">x: </span><span class="nx">o</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">radAngle</span><span class="p">)</span><span class="o">*</span><span class="nx">radiusX</span><span class="p">)</span>
      <span class="nv">y: </span><span class="nx">o</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">radAngle</span><span class="p">)</span><span class="o">*</span><span class="nx">radiusY</span><span class="p">)</span>
  <span class="nx">getPrefix</span><span class="o">:</span><span class="nf">-&gt;</span>
    <span class="nv">styles = </span><span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="nv">v = </span><span class="nb">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">styles</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">).</span><span class="nx">match</span><span class="p">(</span><span class="sr">/-(moz|webkit|ms)-/</span><span class="p">)</span>
    <span class="nv">pre = </span><span class="p">(</span><span class="nx">v</span> <span class="o">or</span> <span class="p">(</span><span class="nx">styles</span><span class="p">.</span><span class="nx">OLink</span> <span class="o">is</span> <span class="s">&quot;&quot;</span> <span class="o">and</span> <span class="p">[</span>
      <span class="s">&quot;&quot;</span>
      <span class="s">&quot;o&quot;</span>
    <span class="p">]))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nv">dom = </span><span class="p">(</span><span class="s">&quot;WebKit|Moz|MS|O&quot;</span><span class="p">).</span><span class="nx">match</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nx">pre</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nv">dom: </span><span class="nx">dom</span>
    <span class="nv">lowercase: </span><span class="nx">pre</span>
    <span class="nv">css: </span><span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="nx">pre</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span>
    <span class="nv">js: </span><span class="nx">pre</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="nx">pre</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="nx">strToArr</span><span class="o">:</span><span class="nf">(string)-&gt;</span>
    <span class="nv">arr = </span><span class="p">[]</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>plain number</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">string</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span> <span class="o">and</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
      <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@parseUnit</span> <span class="nx">string</span>
      <span class="k">return</span> <span class="nx">arr</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>string array</p></div></div><div class="code"><div class="wrapper">    <span class="nx">string</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/gim</span><span class="p">).</span><span class="nx">forEach</span> <span class="nf">(str)=&gt;</span>
      <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@parseUnit</span> <span class="nx">@parseIfRand</span> <span class="nx">str</span>
    <span class="nx">arr</span>
  
  <span class="nx">calcArrDelta</span><span class="o">:</span><span class="nf">(arr1, arr2)-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if !arr1? or !arr2? then throw Error 'Two arrays should be passed'
if !@isArray(arr1)or!@isArray(arr2) then throw Error 'Two arrays expected'</p></div></div><div class="code"><div class="wrapper">    <span class="nv">delta = </span><span class="p">[]</span>
    <span class="k">for</span> <span class="nx">num</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">arr1</span>
      <span class="nx">delta</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">@parseUnit</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">arr2</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span> <span class="o">-</span> <span class="nx">arr1</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="si">}#{</span><span class="nx">arr2</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">delta</span>

  <span class="nx">isArray</span><span class="o">:</span><span class="nf">(variable)-&gt;</span> <span class="nx">variable</span> <span class="k">instanceof</span> <span class="nb">Array</span>

  <span class="nx">normDashArrays</span><span class="o">:</span><span class="nf">(arr1, arr2)-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if !arr1? or !arr2? then throw Error 'Two arrays should be passed'</p></div></div><div class="code"><div class="wrapper">    <span class="nv">arr1Len = </span><span class="nx">arr1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nv">arr2Len = </span><span class="nx">arr2</span><span class="p">.</span><span class="nx">length</span>
    <span class="k">if</span> <span class="nx">arr1Len</span> <span class="o">&gt;</span> <span class="nx">arr2Len</span>
      <span class="nv">lenDiff = </span><span class="nx">arr1Len</span><span class="o">-</span><span class="nx">arr2Len</span><span class="p">;</span> <span class="nv">startI = </span><span class="nx">arr2</span><span class="p">.</span><span class="nx">length</span>
      <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">lenDiff</span><span class="p">]</span>
        <span class="nv">currItem = </span><span class="nx">i</span> <span class="o">+</span> <span class="nx">startI</span>
        <span class="nx">arr2</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@parseUnit</span> <span class="s">&quot;0</span><span class="si">#{</span><span class="nx">arr1</span><span class="p">[</span><span class="nx">currItem</span><span class="p">].</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">arr2Len</span> <span class="o">&gt;</span> <span class="nx">arr1Len</span>
      <span class="nv">lenDiff = </span><span class="nx">arr2Len</span><span class="o">-</span><span class="nx">arr1Len</span><span class="p">;</span> <span class="nv">startI = </span><span class="nx">arr1</span><span class="p">.</span><span class="nx">length</span>
      <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">lenDiff</span><span class="p">]</span>
        <span class="nv">currItem = </span><span class="nx">i</span> <span class="o">+</span> <span class="nx">startI</span>
        <span class="nx">arr1</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@parseUnit</span> <span class="s">&quot;0</span><span class="si">#{</span><span class="nx">arr2</span><span class="p">[</span><span class="nx">currItem</span><span class="p">].</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="p">[</span> <span class="nx">arr1</span><span class="p">,</span> <span class="nx">arr2</span> <span class="p">]</span>

  <span class="nx">makeColorObj</span><span class="o">:</span><span class="nf">(color)-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>HEX</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s">&#39;#&#39;</span>
      <span class="nv">result = </span><span class="sr">/^#?([a-f\d]{1,2})([a-f\d]{1,2})([a-f\d]{1,2})$/i</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">color</span><span class="p">)</span>
      <span class="nv">colorObj = </span><span class="p">{}</span>
      <span class="k">if</span> <span class="nx">result</span>
        <span class="nv">r = </span><span class="k">if</span> <span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">2</span> <span class="k">then</span> <span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nv">g = </span><span class="k">if</span> <span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">2</span> <span class="k">then</span> <span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="nv">b = </span><span class="k">if</span> <span class="nx">result</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">2</span> <span class="k">then</span> <span class="nx">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">else</span> <span class="nx">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="nx">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="nv">colorObj =</span>
          <span class="nv">r: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
          <span class="nv">g: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
          <span class="nv">b: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
          <span class="nv">a: </span><span class="mi">1</span>
    </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>not HEX
shorthand color and rgb()</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">isnt</span> <span class="s">&#39;#&#39;</span>
      <span class="nv">isRgb = </span><span class="nx">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s">&#39;r&#39;</span> <span class="o">and</span> <span class="nx">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">is</span> <span class="s">&#39;g&#39;</span> <span class="o">and</span> <span class="nx">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">is</span> <span class="s">&#39;b&#39;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>rgb color</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="nx">isRgb</span>
        <span class="nv">rgbColor = </span><span class="nx">color</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>shorthand color name</p></div></div><div class="code"><div class="wrapper">      <span class="k">if</span> <span class="o">!</span><span class="nx">isRgb</span>
        <span class="nv">rgbColor = </span><span class="k">if</span> <span class="o">!</span><span class="nx">@shortColors</span><span class="p">[</span><span class="nx">color</span><span class="p">]</span>
          <span class="vi">@div.style.color = </span><span class="nx">color</span>
          <span class="k">if</span> <span class="nx">@isFF</span> <span class="o">or</span> <span class="nx">@isIE</span> <span class="o">or</span> <span class="nx">@isOldOpera</span>
            <span class="nv">style = </span><span class="nx">@computedStyle</span><span class="p">(</span><span class="nx">@div</span><span class="p">)</span>
            <span class="nx">@computedStyle</span><span class="p">(</span><span class="nx">@div</span><span class="p">).</span><span class="nx">color</span>
          <span class="k">else</span> <span class="nx">@div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span>
        <span class="k">else</span> <span class="nx">@shortColors</span><span class="p">[</span><span class="nx">color</span><span class="p">]</span>

      <span class="nv">regexString1 = </span><span class="s">&#39;^rgba?\\((\\d{1,3}),\\s?(\\d{1,3}),&#39;</span>
      <span class="nv">regexString2 = </span><span class="s">&#39;\\s?(\\d{1,3}),?\\s?(\\d{1}|0?\\.\\d{1,})?\\)$&#39;</span>
      <span class="nv">result = </span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">regexString1</span> <span class="o">+</span> <span class="nx">regexString2</span><span class="p">,</span> <span class="s">&#39;gi&#39;</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="nx">rgbColor</span><span class="p">)</span>
      <span class="nv">colorObj = </span><span class="p">{}</span>
      <span class="nv">alpha = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">or</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">result</span>
        <span class="nv">colorObj =</span>
          <span class="nv">r: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
          <span class="nv">g: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
          <span class="nv">b: </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
          <span class="nv">a: </span><span class="k">if</span> <span class="nx">alpha</span><span class="o">?</span> <span class="o">and</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">alpha</span><span class="p">)</span> <span class="k">then</span> <span class="nx">alpha</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="nx">colorObj</span>

  <span class="nx">computedStyle</span><span class="o">:</span><span class="nf">(el)-&gt;</span> <span class="nx">getComputedStyle</span> <span class="nx">el</span>

  <span class="nx">splitEasing</span><span class="o">:</span><span class="nf">(string)-&gt;</span>
    <span class="k">return</span> <span class="nx">string</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">string</span> <span class="o">is</span> <span class="s">&#39;function&#39;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">string</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span> <span class="o">and</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span>
      <span class="nv">split = </span><span class="nx">string</span><span class="p">.</span><span class="nx">split</span> <span class="s">&#39;.&#39;</span>
      <span class="nv">firstPart   = </span><span class="nx">split</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">or</span> <span class="s">&#39;linear&#39;</span>
      <span class="nv">secondPart  = </span><span class="nx">split</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">or</span> <span class="s">&#39;none&#39;</span>
      <span class="p">[</span> <span class="nx">firstPart</span><span class="p">,</span> <span class="nx">secondPart</span> <span class="p">]</span>
    <span class="k">else</span> <span class="p">[</span><span class="s">&#39;linear&#39;</span><span class="p">,</span> <span class="s">&#39;none&#39;</span><span class="p">]</span>
  <span class="nx">capitalize</span><span class="o">:</span><span class="nf">(str)-&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">str</span> <span class="o">isnt</span> <span class="s">&#39;string&#39;</span>
      <span class="k">throw</span> <span class="nb">Error</span> <span class="s">&#39;String expected - nothing to capitalize&#39;</span>
    <span class="nx">str</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="nx">parseRand</span><span class="o">:</span><span class="nf">(string)-&gt;</span>
    <span class="nv">randArr = </span><span class="nx">string</span><span class="p">.</span><span class="nx">split</span> <span class="sr">/rand\(|\,|\)/</span>
    <span class="nv">units = </span><span class="nx">@parseUnit</span> <span class="nx">randArr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="nv">rand = </span><span class="nx">@rand</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">randArr</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">randArr</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nx">units</span><span class="p">.</span><span class="nx">unit</span> <span class="o">and</span> <span class="nx">randArr</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="nx">units</span><span class="p">.</span><span class="nx">unit</span><span class="p">)</span><span class="k">then</span> <span class="nx">rand</span> <span class="o">+</span> <span class="nx">units</span><span class="p">.</span><span class="nx">unit</span>
    <span class="k">else</span> <span class="nx">rand</span>
  <span class="nx">parseStagger</span><span class="o">:</span><span class="nf">(string, index)-&gt;</span>
    <span class="nv">value = </span><span class="nx">string</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/stagger\(|\)$/</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>split the value in case it contains base
the regex splits 0,0 0,1 1,0 1,1 combos
if num taken as 1, rand() taken as 0</p></div></div><div class="code"><div class="wrapper">    <span class="nv">splittedValue = </span><span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/(rand\(.*?\)|[^\(,\s]+)(?=\s*,|\s*$)/gim</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if contains the base value</p></div></div><div class="code"><div class="wrapper">    <span class="nv">value = </span><span class="k">if</span> <span class="nx">splittedValue</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">3</span>
      <span class="nv">base = </span><span class="nx">@parseUnit</span><span class="p">(</span><span class="nx">@parseIfRand</span><span class="p">(</span><span class="nx">splittedValue</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="nx">splittedValue</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if just a plain value</p></div></div><div class="code"><div class="wrapper">    <span class="k">else</span> <span class="nv">base = </span><span class="nx">@parseUnit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="nx">splittedValue</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="nv">value = </span><span class="nx">@parseIfRand</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>parse with units</p></div></div><div class="code"><div class="wrapper">    <span class="nv">unitValue = </span><span class="nx">@parseUnit</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
    <span class="nv">number = </span><span class="nx">index</span><span class="o">*</span><span class="nx">unitValue</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">base</span><span class="p">.</span><span class="nx">value</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>add units only if option had a unit before</p></div></div><div class="code"><div class="wrapper">    <span class="nv">unit = </span><span class="k">if</span> <span class="nx">base</span><span class="p">.</span><span class="nx">isStrict</span> <span class="k">then</span> <span class="nx">base</span><span class="p">.</span><span class="nx">unit</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">unitValue</span><span class="p">.</span><span class="nx">isStrict</span> <span class="k">then</span> <span class="nx">unitValue</span><span class="p">.</span><span class="nx">unit</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
    
    <span class="k">if</span> <span class="nx">unit</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">number</span><span class="si">}#{</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">else</span> <span class="nx">number</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if passed string has rand function then get the rand value</p></div></div><div class="code"><div class="wrapper">  <span class="nx">parseIfRand</span><span class="o">:</span><span class="nf">(str)-&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">str</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span> <span class="o">and</span> <span class="nx">str</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/rand\(/</span><span class="p">)</span> <span class="k">then</span> <span class="nx">@parseRand</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>
    <span class="k">else</span> <span class="nx">str</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if delta object was passed: like { 20: 75 }</p></div></div><div class="code"><div class="wrapper">  <span class="nx">parseDelta</span><span class="o">:</span><span class="nf">(key, value)-&gt;</span>
    <span class="nv">start = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nv">end   = </span><span class="nx">value</span><span class="p">[</span><span class="nx">start</span><span class="p">]</span>
    <span class="nv">delta = start: </span><span class="nx">start</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>color values</p></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">start</span><span class="p">))</span> <span class="o">and</span> <span class="o">!</span><span class="nx">start</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/rand\(/</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">key</span> <span class="o">is</span> <span class="s">&#39;strokeLinecap&#39;</span>
        <span class="nx">@warn</span> <span class="s">&quot;Sorry, stroke-linecap property is not animatable</span>
<span class="s">           yet, using the start(</span><span class="si">#{</span><span class="nx">start</span><span class="si">}</span><span class="s">) value instead&quot;</span><span class="p">,</span> <span class="nx">value</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> props</span></p></div></div><div class="code"><div class="wrapper">        <span class="k">return</span> <span class="nx">delta</span>
      <span class="nv">startColorObj = </span><span class="nx">@makeColorObj</span> <span class="nx">start</span>
      <span class="nv">endColorObj   = </span><span class="nx">@makeColorObj</span> <span class="nx">end</span>
      <span class="nv">delta  =</span>
        <span class="nv">start: </span> <span class="nx">startColorObj</span>
        <span class="nv">end: </span>   <span class="nx">endColorObj</span>
        <span class="nv">type: </span>  <span class="s">&#39;color&#39;</span>
        <span class="nv">delta:</span>
          <span class="nv">r: </span><span class="nx">endColorObj</span><span class="p">.</span><span class="nx">r</span> <span class="o">-</span> <span class="nx">startColorObj</span><span class="p">.</span><span class="nx">r</span>
          <span class="nv">g: </span><span class="nx">endColorObj</span><span class="p">.</span><span class="nx">g</span> <span class="o">-</span> <span class="nx">startColorObj</span><span class="p">.</span><span class="nx">g</span>
          <span class="nv">b: </span><span class="nx">endColorObj</span><span class="p">.</span><span class="nx">b</span> <span class="o">-</span> <span class="nx">startColorObj</span><span class="p">.</span><span class="nx">b</span>
          <span class="nv">a: </span><span class="nx">endColorObj</span><span class="p">.</span><span class="nx">a</span> <span class="o">-</span> <span class="nx">startColorObj</span><span class="p">.</span><span class="nx">a</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>color strokeDasharray/strokeDashoffset</p></div></div><div class="code"><div class="wrapper">    <span class="k">else</span> <span class="k">if</span> <span class="nx">key</span> <span class="o">is</span> <span class="s">&#39;strokeDasharray&#39;</span> <span class="o">or</span> <span class="nx">key</span> <span class="o">is</span> <span class="s">&#39;strokeDashoffset&#39;</span>
      <span class="nv">startArr  = </span><span class="nx">@strToArr</span> <span class="nx">start</span>
      <span class="nv">endArr    = </span><span class="nx">@strToArr</span> <span class="nx">end</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>console.log startArr, endArr</p></div></div><div class="code"><div class="wrapper">      <span class="nx">@normDashArrays</span> <span class="nx">startArr</span><span class="p">,</span> <span class="nx">endArr</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>console.log startArr, endArr</p></div></div><div class="code"><div class="wrapper">      <span class="k">for</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">startArr</span>
        <span class="nv">end = </span><span class="nx">endArr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
        <span class="nx">@mergeUnits</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">,</span> <span class="nx">key</span>

      <span class="nv">delta =</span>
        <span class="nv">start: </span> <span class="nx">startArr</span>
        <span class="nv">end: </span>   <span class="nx">endArr</span>
        <span class="nv">delta: </span> <span class="nx">@calcArrDelta</span> <span class="nx">startArr</span><span class="p">,</span> <span class="nx">endArr</span>
        <span class="nv">type: </span>  <span class="s">&#39;array&#39;</span>
    <span class="c1">## plain numeric value ##</span>
    <span class="k">else</span>
      <span class="c1">## filter tween-related properties</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>defined in helpers.chainOptionMap
because tween-related props shouldn't</p></div></div><div class="code"><div class="wrapper">      <span class="c1">## have deltas</span>
      <span class="k">if</span> <span class="o">!</span><span class="nx">@chainOptionMap</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>position values defined in posPropsMap</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="nx">@posPropsMap</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
          <span class="nv">end   = </span><span class="nx">@parseUnit</span> <span class="nx">@parseIfRand</span> <span class="nx">end</span>
          <span class="nv">start = </span><span class="nx">@parseUnit</span> <span class="nx">@parseIfRand</span> <span class="nx">start</span>
          <span class="nx">@mergeUnits</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">,</span> <span class="nx">key</span>
          <span class="nv">delta =</span>
            <span class="nv">start: </span> <span class="nx">start</span>
            <span class="nv">end: </span>   <span class="nx">end</span>
            <span class="nv">delta: </span> <span class="nx">end</span><span class="p">.</span><span class="nx">value</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">value</span>
            <span class="nv">type: </span>  <span class="s">&#39;unit&#39;</span>
        <span class="k">else</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>none position but numeric values</p></div></div><div class="code"><div class="wrapper">          <span class="nv">end   = </span><span class="nb">parseFloat</span> <span class="nx">@parseIfRand</span>    <span class="nx">end</span>
          <span class="nv">start = </span><span class="nb">parseFloat</span> <span class="nx">@parseIfRand</span>  <span class="nx">start</span>
          <span class="nv">delta =</span>
            <span class="nv">start: </span> <span class="nx">start</span>
            <span class="nv">end: </span>   <span class="nx">end</span>
            <span class="nv">delta: </span> <span class="nx">end</span> <span class="o">-</span> <span class="nx">start</span>
            <span class="nv">type: </span>  <span class="s">&#39;number&#39;</span>
    <span class="nx">delta</span>

  <span class="nx">mergeUnits</span><span class="o">:</span><span class="nf">(start, end, key)-&gt;</span>
    <span class="k">if</span> <span class="o">!</span><span class="nx">end</span><span class="p">.</span><span class="nx">isStrict</span> <span class="o">and</span> <span class="nx">start</span><span class="p">.</span><span class="nx">isStrict</span>
      <span class="nv">end.unit = </span><span class="nx">start</span><span class="p">.</span><span class="nx">unit</span>
      <span class="nv">end.string = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">end</span><span class="p">.</span><span class="nx">value</span><span class="si">}#{</span><span class="nx">end</span><span class="p">.</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">end</span><span class="p">.</span><span class="nx">isStrict</span> <span class="o">and</span> <span class="o">!</span><span class="nx">start</span><span class="p">.</span><span class="nx">isStrict</span>
      <span class="nv">start.unit = </span><span class="nx">end</span><span class="p">.</span><span class="nx">unit</span>
      <span class="nv">start.string = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">start</span><span class="p">.</span><span class="nx">value</span><span class="si">}#{</span><span class="nx">start</span><span class="p">.</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">end</span><span class="p">.</span><span class="nx">isStrict</span> <span class="o">and</span> <span class="nx">start</span><span class="p">.</span><span class="nx">isStrict</span>
      <span class="k">if</span> <span class="nx">end</span><span class="p">.</span><span class="nx">unit</span> <span class="o">isnt</span> <span class="nx">start</span><span class="p">.</span><span class="nx">unit</span>
        <span class="nv">start.unit = </span><span class="nx">end</span><span class="p">.</span><span class="nx">unit</span>
        <span class="nv">start.string = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">start</span><span class="p">.</span><span class="nx">value</span><span class="si">}#{</span><span class="nx">start</span><span class="p">.</span><span class="nx">unit</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nx">@warn</span> <span class="s">&quot;Two different units were specified on \&quot;</span><span class="si">#{</span><span class="nx">key</span><span class="si">}</span><span class="s">\&quot; delta</span>
<span class="s">           property, mo Â· js will fallback to end \&quot;</span><span class="si">#{</span><span class="nx">end</span><span class="p">.</span><span class="nx">unit</span><span class="si">}</span><span class="s">\&quot; unit &quot;</span>

  <span class="nx">rand</span><span class="o">:</span><span class="nf">(min,max)-&gt;</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">((</span><span class="nx">max</span><span class="p">)</span> <span class="o">-</span> <span class="nx">min</span><span class="p">))</span> <span class="o">+</span> <span class="nx">min</span>
  <span class="nx">isDOM</span><span class="o">:</span><span class="nf">(o)-&gt;</span>
    <span class="k">return</span> <span class="kc">false</span> <span class="k">if</span> <span class="o">!</span><span class="nx">o</span><span class="o">?</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if typeof Node is 'function' then o instanceof Node
else</p></div></div><div class="code"><div class="wrapper">    <span class="nv">isNode = </span><span class="k">typeof</span> <span class="nx">o</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span> <span class="o">and</span> <span class="k">typeof</span> <span class="nx">o</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span>
    <span class="k">typeof</span> <span class="nx">o</span> <span class="o">is</span> <span class="s">&#39;object&#39;</span> <span class="o">and</span> <span class="nx">isNode</span>
  
  
  <span class="nx">getChildElements</span><span class="o">:</span><span class="nf">(element)-&gt;</span>
    <span class="nv">childNodes = </span><span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span>
    <span class="nv">children = </span><span class="p">[]</span>
    <span class="nv">i = </span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span>
    <span class="k">while</span> <span class="nx">i</span><span class="o">--</span>
      <span class="k">if</span> <span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeType</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="nx">children</span><span class="p">.</span><span class="nx">unshift</span> <span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
    <span class="nx">children</span>

  
  <span class="nx">delta</span><span class="o">:</span><span class="nf">(start, end)-&gt;</span>
    <span class="nv">type1 = </span><span class="k">typeof</span> <span class="nx">start</span><span class="p">;</span> <span class="nv">type2 = </span><span class="k">typeof</span> <span class="nx">end</span>
    <span class="nv">isType1 = </span><span class="nx">type1</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span> <span class="o">or</span> <span class="nx">type1</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span> <span class="o">and</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">start</span><span class="p">)</span>
    <span class="nv">isType2 = </span><span class="nx">type2</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span> <span class="o">or</span> <span class="nx">type2</span> <span class="o">is</span> <span class="s">&#39;number&#39;</span> <span class="o">and</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">end</span><span class="p">)</span>
    <span class="k">if</span> <span class="o">!</span><span class="nx">isType1</span> <span class="o">or</span> <span class="o">!</span><span class="nx">isType2</span>
      <span class="nx">@error</span> <span class="s">&quot;delta method expects Strings or Numbers at input</span>
<span class="s">         but got - </span><span class="si">#{</span><span class="nx">start</span><span class="si">}</span><span class="s">, </span><span class="si">#{</span><span class="nx">end</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">return</span>
    <span class="nv">obj = </span><span class="p">{};</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">start</span><span class="p">]</span> <span class="o">=</span> <span class="nx">end</span><span class="p">;</span> <span class="nx">obj</span>


<span class="nv">h = </span><span class="k">new</span> <span class="nx">Helpers</span>
<span class="nv">module.exports = </span><span class="nx">h</span></div></div></div></div></body></html>